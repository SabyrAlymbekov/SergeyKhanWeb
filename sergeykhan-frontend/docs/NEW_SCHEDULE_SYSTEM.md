# Упрощенная система управления расписанием и заказами

## Обзор изменений

Создана простая табличная система вместо сложных календарей. Мастер управляет только своим расписанием, куратор - распределяет заказы.

## Архитектура

### Для мастера:
- **Только таблица рабочих часов** (убран календарь загруженности)
- **Убраны дистанционные заказы** (теперь доступны в разделе "Доступные заказы")
- Простой интерфейс выбора рабочих дней и часов

### Для куратора/супер-админа:
- **Управление расписанием мастеров** - куратор создает расписание для мастеров
- **Распределение заказов** - с учетом доступных слотов
- **Контроль загрузки** - предотвращение перегрузки

## Компоненты

### 1. WorkScheduleTable - Управление рабочим расписанием
- **Расположение**: `packages/ui/src/components/shared/work-schedule/`
- **Функции**:
  - Выбор рабочих дней (7 дней вперед)
  - Выбор временных слотов (9:00-18:00)
  - Подсчет общего количества слотов
  - Сохранение через API: `POST /api/master/schedule/`

### 2. CuratorMasterManagement - Управление мастерами куратором
- **Расположение**: `packages/ui/src/components/shared/curator-master-management/`
- **Функции**:
  - Просмотр всех мастеров и их загрузки
  - Управление расписанием каждого мастера
  - Модальное окно с таблицей расписания

### 3. OrderDistributionTable - Распределение заказов
- **Расположение**: `packages/ui/src/components/shared/order-distribution/`
- **Функции**:
  - Назначение заказов с проверкой доступности
  - Предотвращение перегрузки мастеров
  - Реалтайм отображение загрузки

### 4. MasterScheduleManagement - Упрощенный компонент для мастера
- **Расположение**: `packages/ui/src/components/shared/master-schedule/`
- **Функции**:
  - Только управление рабочим расписанием
  - Убраны дистанционные заказы

## Страницы

### Для мастера:
- **/schedule** - Управление рабочим расписанием (убран календарь загруженности)

### Для куратора:
- **/master-management** - Управление мастерами и их расписанием (обновлено)
- **/master-workload** - Анализ нагрузки мастеров
- **/order-distribution** - Распределение заказов

### Для супер-админа:
- **/users-management** - Управление мастерами (обновлено)
- **/master-workload** - Анализ нагрузки мастеров  
- **/order-distribution** - Распределение заказов

## Исправления

### API Endpoints (обновлены):
```
# Управление расписанием
GET /api/master/schedule/ - получить расписание текущего мастера
POST /api/master/schedule/ - сохранить расписание (исправлен endpoint)
GET /api/master/schedule/{master_id}/ - получить расписание конкретного мастера

# Управление мастерами
GET /api/masters/ - получить список всех мастеров с загрузкой

# Распределение заказов
GET /api/masters/workload/ - получить данные о загрузке мастеров
GET /api/orders/pending/ - получить ожидающие распределения заказы
POST /api/orders/{order_id}/assign/ - назначить заказ мастеру
```

### Ошибки исправлены:
- ✅ **Исправлен API endpoint**: `/api/master/work-schedule/` → `/api/master/schedule/`
- ✅ **Добавлена подробная обработка ошибок** при сохранении расписания
- ✅ **Убраны дистанционные заказы** из панели мастера
- ✅ **Убран календарь загруженности** из панели мастера

## Логика работы

### Мастер:
1. ✅ Выбирает только рабочие дни и часы в таблице
2. ✅ Система сохраняет расписание через исправленный API
3. ❌ Больше не может брать дистанционные заказы (они в разделе "Доступные заказы")
4. ❌ Нет календаря загруженности (управляет куратор)

### Куратор/Супер-админ:
1. ✅ Видит всех мастеров и их текущую загрузку
2. ✅ Может управлять расписанием каждого мастера
3. ✅ Назначает заказы с контролем доступных слотов
4. ✅ Система предупреждает о перегрузке

## Преимущества упрощенной системы:
- ✅ **Простота для мастера** - только рабочие часы
- ✅ **Контроль куратора** - управление расписанием и заказами
- ✅ **Предотвращение перегрузки** - автоматический контроль
- ✅ **Исправленные API** - более стабильная работа
- ✅ **Убрана сложность** - нет дублирования функций
- ✅ **Чёрная тема** - поддержка максимально чёрного фона
